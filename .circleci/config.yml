version: 2.1
orbs:
  eventuate-gradle-build-and-test: "eventuate_io/eventuate-gradle-build-and-test@0.2.9"
workflows:
  version: 2
  build-test-and-deploy:
    jobs:
      - eventuate-gradle-build-and-test/build-and-test:
          name: build-and-test-mysql
          script: ./scripts/build-and-test-all-mysql.sh
      - eventuate-gradle-build-and-test/build-and-test:
          name: build-and-test-mysql-spring-boot-3
          script: ./scripts/build-and-test-all-mysql-spring-boot-3.sh
      - eventuate-gradle-build-and-test/build-and-test:
          name: build-and-test-mssql
          script: ./scripts/build-and-test-all-mssql.sh
      - eventuate-gradle-build-and-test/build-and-test:
          name: build-and-test-postgres
          script: ./scripts/build-and-test-all-postgres.sh
      - eventuate-gradle-build-and-test/build-and-test:
          name: deploy-artifacts
          context:
            - publish
          requires:
            - build-and-test-mysql
            - build-and-test-mysql-spring-boot-3
            - build-and-test-mssql
            - build-and-test-postgres
          script: ./scripts/deploy-artifacts.sh
